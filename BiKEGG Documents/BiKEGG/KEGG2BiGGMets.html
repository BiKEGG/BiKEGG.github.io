<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
<head>
  <title>Description of KEGG2BiGGMets</title>
  <meta name="keywords" content="KEGG2BiGGMets">
  <meta name="description" content="KEGG2BiGGMets">
  <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
  <meta name="generator" content="m2html v1.5 &copy; 2003-2005 Guillaume Flandin">
  <meta name="robots" content="bidocs, follow">
  <link type="text/css" rel="stylesheet" href="../m2html.css">
</head>
<body>
<a name="_top"></a>
<div><a href="../bidocs.html">Home</a> &gt;  <a href="bidocs.html">BiKEGG</a> &gt; KEGG2BiGGMets.m</div>

<!--<table width="100%"><tr><td align="left"><a href="../bidocs.html"><img alt="<" border="0" src="../left.png">&nbsp;Master bidocs</a></td>
<td align="right"><a href="bidocs.html">bidocs for BiKEGG&nbsp;<img alt=">" border="0" src="../right.png"></a></td></tr></table>-->

<h1>KEGG2BiGGMets
</h1>

<h2><a name="_name"></a>PURPOSE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>KEGG2BiGGMets</strong></div>

<h2><a name="_synopsis"></a>SYNOPSIS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="box"><strong>function [Metkegg,Metbigg] = KEGG2BiGGMets(D,CbModel) </strong></div>

<h2><a name="_description"></a>DESCRIPTION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre class="comment"> KEGG2BiGGMets
 is a subfunction of MapAdjuster for displaying compound's
 data on created customized metabolic map by NetDraw. The function
 extracts all metabolite correspondences between KEGG and BiGG based on
 the current COBRA model and data in BiGG API generated by
 AllKEGG2BiGGmet. The structure is very similar to that of used in
 Bigg2Kegg with minor adjustments.
 
 Inputs:
 D: XML data of current COBRA model from BiGG
 CbModel: current COBRA model structure
 
 Outputs:
 Metkegg: All KEGG compounds' IDs
 Metbigg: All BiGG compounds' IDs</pre></div>

<!-- crossreference -->
<h2><a name="_cross"></a>CROSS-REFERENCE INFORMATION <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
This function calls:
<ul style="list-style-image:url(../matlabicon.gif)">
</ul>
This function is called by:
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="ArrowheadProcess.html" class="code" title="function [ArX,ArY,Cntrs,Director] = ArrowheadProcess(Xin1,Yin1,min_x,min_y,idx,basemap,JumpData,RefOverlapData,ID,flx_idx)">ArrowheadProcess</a>	ArrowheadProcess</li><li><a href="MapAdjuster.html" class="code" title="function varargout = MapAdjuster(varargin)">MapAdjuster</a>	MapAdjuster(GUI)</li></ul>
<!-- crossreference -->

<h2><a name="_subfunctions"></a>SUBFUNCTIONS <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<ul style="list-style-image:url(../matlabicon.gif)">
<li><a href="#_sub1" class="code">function Metkegg = ModelMoidfy (Metkegg,MetAbr)</a></li></ul>

<h2><a name="_source"></a>SOURCE CODE <a href="#_top"><img alt="^" border="0" src="../up.png"></a></h2>
<div class="fragment"><pre>0001 <a name="_sub0" href="#_subfunctions" class="code">function [Metkegg,Metbigg] = KEGG2BiGGMets(D,CbModel)</a>
0002 <span class="comment">% KEGG2BiGGMets</span>
0003 <span class="comment">% is a subfunction of MapAdjuster for displaying compound's</span>
0004 <span class="comment">% data on created customized metabolic map by NetDraw. The function</span>
0005 <span class="comment">% extracts all metabolite correspondences between KEGG and BiGG based on</span>
0006 <span class="comment">% the current COBRA model and data in BiGG API generated by</span>
0007 <span class="comment">% AllKEGG2BiGGmet. The structure is very similar to that of used in</span>
0008 <span class="comment">% Bigg2Kegg with minor adjustments.</span>
0009 <span class="comment">%</span>
0010 <span class="comment">% Inputs:</span>
0011 <span class="comment">% D: XML data of current COBRA model from BiGG</span>
0012 <span class="comment">% CbModel: current COBRA model structure</span>
0013 <span class="comment">%</span>
0014 <span class="comment">% Outputs:</span>
0015 <span class="comment">% Metkegg: All KEGG compounds' IDs</span>
0016 <span class="comment">% Metbigg: All BiGG compounds' IDs</span>
0017 
0018 <span class="comment">% O. Jamialahmadi</span>
0019 <span class="comment">% TMU, Chem. Eng. Dept., Biotech. Group</span>
0020 <span class="comment">% July 2016</span>
0021 <span class="comment">% -------------------------------------------------------------------------</span>
0022 
0023 Pth1 = which (<span class="string">'Bigg2Kegg.m'</span>);
0024 tind = find(Pth1==<span class="string">'\'</span>,1,<span class="string">'last'</span>);
0025 Pth = Pth1(1:tind-1);
0026 <span class="comment">% Reading xml</span>
0027 <span class="comment">% Find listOfSpecies which contains metabolite annotations</span>
0028 SpeciesLoci1 = strfind(D{1},<span class="string">'listOfSpecies'</span>);
0029 SpeciesLoci = find(~cellfun(<span class="string">'isempty'</span>, SpeciesLoci1));
0030 <span class="comment">% Discard other data in the model:</span>
0031 SpeciesData = D{1}(SpeciesLoci(1):SpeciesLoci(2));
0032 clear D
0033 <span class="comment">% Find each metabolite-------------------------------------------------</span>
0034 SpeciesStart1 = strfind(SpeciesData,<span class="string">'&lt;species'</span>);
0035 SpeciesStart = find(~cellfun(<span class="string">'isempty'</span>, SpeciesStart1));
0036 SpeciesEnd1 = strfind(SpeciesData,<span class="string">'&lt;/species&gt;'</span>);
0037 SpeciesEnd = find(~cellfun(<span class="string">'isempty'</span>, SpeciesEnd1));
0038 <span class="keyword">if</span> numel(SpeciesStart) ~= numel(SpeciesEnd)
0039     msgbox(<span class="string">'SBML format error:Species have wrong format!'</span>,<span class="string">'Error'</span>,<span class="keyword">...</span>
0040         <span class="string">'error'</span>);
0041     <span class="keyword">return</span>
0042 <span class="keyword">end</span>
0043 <span class="comment">% ---------------------------------------------------------------------</span>
0044 <span class="comment">% Search for KEGG compounds for each BiGG metabolite. Note that each BiGG</span>
0045 <span class="comment">% metabolite may have more than one equivalent KEGG compund, and although</span>
0046 <span class="comment">% HMR and RECON2 (Thiele lab.) do not provide more than one KEGG compound</span>
0047 <span class="comment">% for each metabolite, here, we followed the format of BiGG models (i.e.</span>
0048 <span class="comment">% several equivalent KEGG compounds for a specific metabolite).</span>
0049 Metkegg = {<span class="string">''</span>}; <span class="comment">% KEGG compounds will fill this cell!</span>
0050 <span class="keyword">for</span> count = 1:numel(SpeciesStart)
0051     SpeciesTempStr = SpeciesData(SpeciesStart(count):SpeciesEnd(count));
0052     SpeciesTempStr = [SpeciesTempStr{:}];
0053     KeggCpdLoci = regexp(SpeciesTempStr,<span class="keyword">...</span>
0054         <span class="string">'(?&lt;=http://identifiers.org/kegg.compound/)[CG]\d{5}'</span>,<span class="string">'match'</span>);
0055     <span class="keyword">if</span> isempty(KeggCpdLoci)
0056         Metkegg{count} = <span class="string">''</span>;
0057         <span class="keyword">continue</span>
0058     <span class="keyword">end</span>
0059     <span class="keyword">for</span> count1 = 1:numel(KeggCpdLoci)
0060         <span class="keyword">if</span> strcmp(KeggCpdLoci{count1},<span class="string">'C00001'</span>) <span class="comment">% H2O</span>
0061             Metkegg{count}= {<span class="string">'C00001'</span>};
0062             <span class="keyword">break</span>
0063         <span class="keyword">elseif</span> strcmp(KeggCpdLoci{count1},<span class="string">'C00027'</span>) <span class="comment">% H2O2</span>
0064             Metkegg{count}= {<span class="string">'C00027'</span>};
0065             <span class="keyword">break</span>
0066         <span class="keyword">else</span>
0067             Metkegg{count}{count1}= KeggCpdLoci{count1};
0068         <span class="keyword">end</span>
0069     <span class="keyword">end</span>
0070 <span class="keyword">end</span>
0071 <span class="comment">% Model modification: some metabolites have wrong/absent KEGG annotations.</span>
0072 <span class="comment">% Therefore, on the basis of modified KEGG compound IDs for RECON1.xml,</span>
0073 <span class="comment">% these metabolites will be added to Metkegg separately.</span>
0074 D = CbModel;
0075 ModelName = D.description;
0076 tind1 = find(ModelName==<span class="string">'\'</span>,1,<span class="string">'last'</span>);
0077 ModelName1 = ModelName(tind1+1:end-4);
0078 <span class="keyword">if</span> ~strcmp(ModelName1,<span class="string">'RECON1'</span>)
0079     MetAbr = CbModel.mets;
0080     Metkegg = <a href="#_sub1" class="code" title="subfunction Metkegg = ModelMoidfy (Metkegg,MetAbr)">ModelMoidfy</a> (Metkegg,MetAbr);
0081 <span class="keyword">end</span>
0082 
0083 load(fullfile(Pth,<span class="string">'AllKEGG2BiGGmet.mat'</span>))
0084 Metkegg1 = AllKEGG2BiGGmet.Metkegg; Metkegg1 = [Metkegg1{:}];
0085 Metbigg1 = AllKEGG2BiGGmet.Metbigg; Metbigg1 = [Metbigg1{:}];
0086 MetAbr = strrep(MetAbr,<span class="string">'['</span>,<span class="string">'_'</span>); MetAbr = strrep(MetAbr,<span class="string">']'</span>,<span class="string">''</span>);
0087 Metkegg2 = ({}); ct = 1; MetAbr1 = ({});
0088 <span class="keyword">for</span> i1 = 1:numel(Metkegg)
0089     <span class="keyword">if</span> isempty(Metkegg{i1})
0090         <span class="keyword">continue</span>
0091     <span class="keyword">end</span>
0092     <span class="keyword">for</span> i2 = 1:numel(Metkegg{i1})
0093         Metkegg2{ct} = Metkegg{i1}{i2};
0094         MetAbr1{ct} = MetAbr{i1};
0095         ct = ct + 1;
0096     <span class="keyword">end</span>
0097 <span class="keyword">end</span>
0098 clear Metkegg 
0099 Metbigg = [Metbigg1,MetAbr1]; Metkegg = [Metkegg1,Metkegg2];
0100 Metbigg = regexp(Metbigg,<span class="string">'\w*(?=_\w{1}\&gt;)'</span>,<span class="string">'match'</span>); <span class="comment">% Remove compartments</span>
0101 Metbigg = [Metbigg{:}];
0102 Mixdat = strcat(Metbigg,Metkegg);
0103 [~, N1] = unique(Mixdat);
0104 Metbigg = Metbigg(N1);
0105 Metkegg = Metkegg(N1);
0106 
0107 <span class="comment">% Consensus Metkegg: Metkegg1 from BiGG API and Metkegg from COBRA models</span>
0108 <span class="comment">% are mixed to generate the most complete set of KEGG metabolites for a</span>
0109 <span class="comment">% SBML model.</span>
0110 <span class="comment">% for cp1 = 1:numel(Metkegg1)</span>
0111 <span class="comment">%     if isempty(Metkegg1{cp1}) || (numel(Metkegg1{cp1}) ~= numel(Metkegg{cp1}))</span>
0112 <span class="comment">%         for cp2 = 1:numel(Metkegg{cp1})</span>
0113 <span class="comment">%             Metkegg1{cp1}{cp2} = Metkegg{cp1}{cp2};</span>
0114 <span class="comment">%         end</span>
0115 <span class="comment">%     end</span>
0116 <span class="comment">% end</span>
0117 
0118 
0119 <a name="_sub1" href="#_subfunctions" class="code">function Metkegg = ModelMoidfy (Metkegg,MetAbr)</a>
0120 <span class="comment">% Read Metkegg data for RECON1.xml</span>
0121 Mdat = load(<span class="string">'RECON1Metkegg.mat'</span>);
0122 RECON1k = Mdat.RECON1meta.K;
0123 RECON1m = Mdat.RECON1meta.B;
0124 [Fx1,Fx2] = ismember(RECON1m,MetAbr);
0125 Fx2(Fx2==0) = [];
0126 <span class="comment">% Metkegg(Fx2) = RECON1k(Fx1);</span>
0127 Fx3 = find(Fx1);
0128 <span class="keyword">for</span> i1 = 1:numel(Fx2)
0129     <span class="keyword">if</span> numel(Metkegg{Fx2(i1)}) &gt; numel(RECON1k{Fx3(i1)})
0130        Tempmet = Metkegg{Fx2(i1)};
0131        whrc = ismember(Tempmet,RECON1k{Fx3(i1)});
0132        <span class="keyword">if</span> isempty(whrc)
0133         Metkegg{Fx2(i1)} = RECON1k(Fx3(i1));
0134         <span class="keyword">end</span>
0135     <span class="keyword">else</span>
0136         Metkegg{Fx2(i1)} = RECON1k{Fx3(i1)};
0137     <span class="keyword">end</span>
0138 <span class="keyword">end</span>
0139</pre></div>
<hr><address>Generated on Sat 16-Jul-2016 20:21:30 by <strong><a href="http://www.artefact.tk/software/matlab/m2html/" title="Matlab Documentation in HTML">m2html</a></strong> &copy; 2005</address>
</body>
</html>